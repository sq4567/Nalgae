# 둥지(Nest) 와이어프레임

## 1. 레이아웃

- **구조**: GridLayout
  - **세부 내용**:
    - 키보드 레이아웃을 재현하기 위해 **RowLayout**과 **ColumnLayout**의 조합 사용.
    - 각 키는 개별 **Button** 컴포넌트로 구현하며, 키의 크기와 간격은 실제 키보드 비율에 맞게 조정.
  - **여백 및 간격**:
    - Margin: 16px
    - Grid 간격: 0px
  - **가이드 패널 표시**:
    - 타이핑 시작 시 레이아웃 상단에 공간이 추가되며, **가이드 패널**이 슬라이드 방식으로 나타남.
    - 가이드 패널이 표시되지 않을 때는 해당 공간이 사라지고 기본 레이아웃으로 복원.
    - **세부 UI/UX 구성은 가이드 패널의 개별 와이어프레임 문서를 참조.**

## 2. 창 설정

- **창 크기**:
  - 기본 크기: 960x411 (21:9 비율 기준 적절한 크기)
  - 최소 크기: 800x342
  - 크기 조정 가능: 유저 창 크기 조정 허용(환경설정에서 변경 가능).
- **창 비율**:
  - 고정 비율: 21:9 유지(환경설정에서 변경 가능).
- **화면 위치**:
  - 기본 위치: 화면 중앙 하단(프로그램 종료 시 이전 세션 위치 저장 및 복원).

## 3. 주요 UI 컴포넌트

- **키보드 레이아웃**:
  - **RowLayout**과 **ColumnLayout**을 중첩하여 키보드 키 배치.
  - **Key Button**:
    - Button (크기: 40x40, 색상: 기본 테마 색상)
    - 각 버튼에 키의 텍스트 및 기능 매핑.
    - 각 버튼의 기본, 호버, 눌림, 비활성 상태에 따른 색상 다르게 표시(Shift, Ctrl, Alt, Win 키는 고정 상태 추가).
- **가이드 패널**:
  - **구조**:
    - HorizontalLayout으로 추천 단어들을 정렬.
    - 각 추천 항목은 개별 **Button**으로 구현.
  - **동작**:
    - 유저가 타이핑을 시작하면 가이드 기능 DB에 저장된 단어/문장 중 유저가 타이핑한 문자열로 시작하는 추천 단어 및 문장이 실시간으로 표시됨.
    - 특수문자 및 공백 문자(\t, 스페이스바, \n 등)를 입력하면:
      1. 가이드 패널은 계속 표시되지만, 추천 단어 목록은 초기화됨.
      2. 다음 타이핑부터 새로운 추천 로직이 적용됨.
    - 추천 항목 클릭 시 해당 단어가 현재 활성화된 프로그램으로 입력됨.
  - **가이드 패널의 사라짐 조건**:
    1. 추천 단어 선택 후 3초 동안 추가 타이핑이 없을 때.
    2. 활성화된 프로그램이 바뀌었을 때.
    3. 환경설정에서 설정한 가이드 기능을 사용하지 않을 프로그램이 활성화되었을 때.
  - **세부 UI/UX 구성은 가이드 패널의 개별 와이어프레임 문서를 참조.**

## 4. 상세 유저 플로우
### **1. 메인 키보드 레이아웃**
- **모든 키 공통**
  - **일반 상태**: 기본 기능이 작동하며, 키 색상은 **일반 상태** 색상(#FFFFFF)으로 표시됨.
  - **호버 상태**: 마우스가 키 위에 올라가면 **호버 상태**로 전환되며, 키 색상이 **호버 상태** 색상(#E0F0FF)으로 변경됨.
  - **좌클릭 눌림 상태**: 키가 좌클릭으로 눌리면 **좌클릭 눌림 상태**로 전환되며, 키 색상이 **좌클릭 눌림 상태** 색상(#CCE5FF)으로 변경됨.
  - **고정 상태**: 키가 고정 상태로 전환되며, 키 색상이 **고정 상태** 색상(#3A86FF)으로 변경됨.
  - **비활성 상태**: 키가 비활성 상태로 전환되며, 키 색상이 **비활성 상태** 색상(#A9A9A9)으로 변경됨.
- **기능 키(Shift, Ctrl, Alt, Win) 공통**
  - **1회 클릭 때마다**:
    - 해당 키가 **on** 상태로 활성화됨.
    - 기능 키가 아닌 다른 키를 클릭하는 순간, 활성화 상태였던 기능 키들은 자동으로 **off** 상태로 전환.
    - 활성화 시 키 색상이 **좌클릭 눌림 상태** 색상(#CCE5FF)으로 변경됨.
  - **1초 이상 길게 누르기**(환경설정에서 시간 설정 가능):
    - 키가 **고정 상태**로 전환되며, 키 색상이 **고정 상태** 색상(#3A86FF)으로 변경됨.
    - 고정 상태에서는 다른 키가 클릭되어도 해당 기능 키기 **off되지 않음**.
    - 동일한 기능 키를 다시 클릭해 고정 상태 해제.
- **한/영 키**
  - **상태 동기화**:
    - 한/영 키의 레이블은 시스템의 IME 상태를 실시간으로 반영:
      - "한글" 상태일 때 레이블: **"한글"**.
      - "영어" 상태일 때 레이블: **"ENG"**.
- **Caps Lock 키**
  - **기본 동작**:
    - (IME 상태가 영어일 때) 클릭 시 자판 레이블의 대/소문자 상태를 토글.
    - (IME 상태가 한글일 때) 클릭 시 한/영 키를 눌러 영어로 바꾼 후 자판 레이블의 대/소문자 상태를 토글.
- **Shift 키**
  - **기본 동작(on/off 시)**:
    - 백틱 키, 숫자 키, -, =, [, ], \, ;, '. ,, ., / 키 레이블 토글.
    - (IME 상태가 영어일 때) 알파벳 레이블의 대/소문자 상태를 토글.
    - (IME 상태가 한글일 때) ㅂ, ㅈ, ㄷ, ㄱ, ㅅ, ㅐ, ㅔ 키 레이블 토글.
### **2. 둥지+가이드 플로우**
- **1. 초기 화면**
  - 유저가 프로그램을 실행하면 기본 키보드 레이아웃이 화면에 표시됨.
  - 키보드 외의 추가 UI 요소(가이드 패널 등)는 비활성 상태로 숨겨져 있음.
- **2. 타이핑 시작**
  - 유저가 키보드에서 첫 번째 키를 입력하면:
    1. 레이아웃 상단에 가이드 패널 표시를 위한 공간이 동적으로 추가됨.
    2. 가이드 패널이 SlideDown 애니메이션과 함께 나타남.
    3. 입력된 문자열 기반으로 추천 단어 및 문장이 실시간으로 업데이트되어 가이드 패널에 표시됨.
- **3. 추천 단어 선택**
  - 유저가 가이드 패널에서 추천 단어 중 하나를 클릭하면:
    1. 해당 단어가 입력 필드에 추가됨.
    2. 추천 단어가 다시 업데이트되며 연속 입력을 지원함.
- **4. 특수문자 및 외부 프로그램 포커스 변경**
  - 유저가 특수문자(\t, \n, 스페이스바 등)를 입력하거나 외부 프로그램으로 포커스를 변경하면:
    1. 가이드 패널은 그대로 표시됨.
    2. 추천 단어 목록은 초기화되어 비워짐.
    3. 다음 입력이 시작되면 새로운 추천 단어 목록이 생성됨.
- **5. 입력 완료 후**
  - 유저가 타이핑을 종료하고 입력 내용을 저장하거나 전송하면:
    1. 모든 추천 데이터와 가이드 패널 상태가 초기화됨.
    2. 키보드 레이아웃만 표시된 초기 화면으로 돌아감.

## 5. UX 테스트 항목

- 키보드 레이아웃이 정확히 표시되고 각 키의 클릭 동작이 올바르게 작동하는지 확인.
- 가이드 패널이 타이핑 동작에 따라 적시에 표시되고 사라지는지 확인.
- 특수문자 입력 시 추천 단어가 초기화되는 동작을 확인.
- 추천 항목 클릭 시 입력 필드에 올바르게 추가되는지 확인.
- 프로그램 포커스 변경 시 가이드 패널의 상태와 추천 단어 초기화 여부를 확인.

## 6. QML 적용 검토

- Qt 6 QML 가이드북의 권장 사항을 기반으로 컴포넌트 속성과 레이아웃 구조 구현 검토.
- **예시**:
  ```qml
  ColumnLayout {
      spacing: 6
      RowLayout {
          id: guidePanel
          visible: isTyping
          opacity: Behavior on visible { NumberAnimation { duration: 250 } }
          Repeater {
              model: guideModel
              Button {
                  text: modelData.suggestion
                  onClicked: inputField.text += modelData.suggestion
              }
          }
      }
      RowLayout {
          Repeater {
              model: keyboardModel
              Button {
                  width: 40; height: 40
                  text: modelData.label
                  onClicked: modelData.action()
              }
          }
      }
  }
  ```

